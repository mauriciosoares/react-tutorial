<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Document</title>
</head>
<body>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react/0.13.3/react.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react/0.13.3/JSXTransformer.js"></script>

  <script type="text/jsx">
    var Picture = React.createClass({
      clickHandler: function() {
        this.props.onClick(this.props.ref);
      },

      render: function() {
        var className = 'picture ' + (this.props.favorite ? 'favorite' : '');

        return (
          <div className={className} onClick={this.clickHandler}>
            <img src={this.props.src} width="200" title={this.props.title} />
          </div>
        );
      }
    });

    var PictureList = React.createClass({
      getInitialState: function() {
        return {
          pictures: [],
          favorites: []
        }
      },

      componentDidMount: function() {
        var url = 'https://api.instagram.com/v1/media/popular?client_id=' + this.props.apiKey + '&callback=?';

        $.getJSON(url, function(result) {
          if(!result || !result.data || !result.data.length) {
            return;
          }

          var pictures = result.data.map(function(picture) {
            return {
              id: picture.id,
              url: picture.link,
              src: picture.images.low_resolution.url,
              title: picture.caption ? picture.caption.text : '',
              favorite: false
            }
          });

          this.setState({
            pictures: pictures
          });
        }.bind(this));
      },

      render: function() {
        console.log(this.state.pictures);
        return <p>1</p>;
      }
    });

    React.render(
      <PictureList apiKey="642176ece1e7445e99244cec26f4de1f" />,
      document.body
    );
  </script>

</body>
</html>
